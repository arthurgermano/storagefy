import{g as J,c as V}from"./_commonjsHelpers.Cpj98o6Y.js";var ue,gt;function ta(){if(gt)return ue;gt=1;function e(t){return typeof t=="number"&&!isNaN(t)&&Number.isFinite(t)}return ue=e,ue}var pe,St;function Tt(){if(St)return pe;St=1;function e(t="",a=!0){let n="";if(typeof t!="string"){if(t)t.toString&&(n=t.toString());else return n;if(a&&n=="[object Object]")try{n=JSON.stringify(t)}catch{return t.toString()}return n}return t}return pe=e,pe}var fe,wt;function ra(){if(wt)return fe;wt=1;const e=ta(),t=Tt();function a(n="",o){let h;return typeof window>"u"?(e(n)&&(n=t(n)),h=Buffer.from(n,o).toString("base64")):h=btoa(n),h.replaceAll("=","")}return fe=a,fe}var aa=ra();const _e=J(aa);var ye,mt;function na(){if(mt)return ye;mt=1;function e(t=""){return typeof t!="string"||!t?"":typeof window>"u"?Buffer.from(t,"base64").toString("utf-8"):atob(t)}return ye=e,ye}var ia=na();const It=J(ia);var ge,bt;function sa(){if(bt)return ge;bt=1;const e=Tt();function t(a,n="_"){return a=e(a)+n,a==n&&(a=""),a+=Date.now(),a+=n+Math.floor(Math.random()*9999999999999+1),a}return ge=t,ge}var oa=sa();const Q=J(oa);var Se,_t;function ca(){if(_t)return Se;_t=1;function e(t,a=!0,n=!1){return new Promise((o,h)=>{setTimeout(()=>{n&&h(a===!0?new Error("Sleep Error"):a),o(a)},t)})}return Se=e,Se}var la=ca();const ha=J(la);var F={exports:{}};F.exports;var xt;function da(){return xt||(xt=1,function(e,t){var a=200,n="__lodash_hash_undefined__",o=9007199254740991,h="[object Arguments]",u="[object Array]",p="[object Boolean]",y="[object Date]",P="[object Error]",A="[object Function]",Ie="[object GeneratorFunction]",j="[object Map]",ke="[object Number]",Z="[object Object]",De="[object Promise]",$e="[object RegExp]",G="[object Set]",Oe="[object String]",Ke="[object Symbol]",ee="[object WeakMap]",Pe="[object ArrayBuffer]",H="[object DataView]",Re="[object Float32Array]",Le="[object Float64Array]",Fe="[object Int8Array]",Be="[object Int16Array]",Je="[object Int32Array]",je="[object Uint8Array]",Ge="[object Uint8ClampedArray]",He="[object Uint16Array]",Me="[object Uint32Array]",Dt=/[\\^$.*+?()[\]{}|]/g,$t=/\w*$/,Ot=/^\[object .+?Constructor\]$/,Kt=/^(?:0|[1-9]\d*)$/,f={};f[h]=f[u]=f[Pe]=f[H]=f[p]=f[y]=f[Re]=f[Le]=f[Fe]=f[Be]=f[Je]=f[j]=f[ke]=f[Z]=f[$e]=f[G]=f[Oe]=f[Ke]=f[je]=f[Ge]=f[He]=f[Me]=!0,f[P]=f[A]=f[ee]=!1;var Pt=typeof V=="object"&&V&&V.Object===Object&&V,Rt=typeof self=="object"&&self&&self.Object===Object&&self,m=Pt||Rt||Function("return this")(),Ue=t&&!t.nodeType&&t,qe=Ue&&!0&&e&&!e.nodeType&&e,Lt=qe&&qe.exports===Ue;function Ft(r,i){return r.set(i[0],i[1]),r}function Bt(r,i){return r.add(i),r}function Jt(r,i){for(var s=-1,d=r?r.length:0;++s<d&&i(r[s],s,r)!==!1;);return r}function jt(r,i){for(var s=-1,d=i.length,g=r.length;++s<d;)r[g+s]=i[s];return r}function ze(r,i,s,d){for(var g=-1,S=r?r.length:0;++g<S;)s=i(s,r[g],g,r);return s}function Gt(r,i){for(var s=-1,d=Array(r);++s<r;)d[s]=i(s);return d}function Ht(r,i){return r?.[i]}function We(r){var i=!1;if(r!=null&&typeof r.toString!="function")try{i=!!(r+"")}catch{}return i}function Ye(r){var i=-1,s=Array(r.size);return r.forEach(function(d,g){s[++i]=[g,d]}),s}function te(r,i){return function(s){return r(i(s))}}function Ve(r){var i=-1,s=Array(r.size);return r.forEach(function(d){s[++i]=d}),s}var Mt=Array.prototype,Ut=Function.prototype,M=Object.prototype,re=m["__core-js_shared__"],Xe=function(){var r=/[^.]+$/.exec(re&&re.keys&&re.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),Qe=Ut.toString,E=M.hasOwnProperty,U=M.toString,qt=RegExp("^"+Qe.call(E).replace(Dt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ze=Lt?m.Buffer:void 0,et=m.Symbol,tt=m.Uint8Array,zt=te(Object.getPrototypeOf,Object),Wt=Object.create,Yt=M.propertyIsEnumerable,Vt=Mt.splice,rt=Object.getOwnPropertySymbols,Xt=Ze?Ze.isBuffer:void 0,Qt=te(Object.keys,Object),ae=D(m,"DataView"),R=D(m,"Map"),ne=D(m,"Promise"),ie=D(m,"Set"),se=D(m,"WeakMap"),L=D(Object,"create"),Zt=T(ae),er=T(R),tr=T(ne),rr=T(ie),ar=T(se),at=et?et.prototype:void 0,nt=at?at.valueOf:void 0;function C(r){var i=-1,s=r?r.length:0;for(this.clear();++i<s;){var d=r[i];this.set(d[0],d[1])}}function nr(){this.__data__=L?L(null):{}}function ir(r){return this.has(r)&&delete this.__data__[r]}function sr(r){var i=this.__data__;if(L){var s=i[r];return s===n?void 0:s}return E.call(i,r)?i[r]:void 0}function or(r){var i=this.__data__;return L?i[r]!==void 0:E.call(i,r)}function cr(r,i){var s=this.__data__;return s[r]=L&&i===void 0?n:i,this}C.prototype.clear=nr,C.prototype.delete=ir,C.prototype.get=sr,C.prototype.has=or,C.prototype.set=cr;function b(r){var i=-1,s=r?r.length:0;for(this.clear();++i<s;){var d=r[i];this.set(d[0],d[1])}}function lr(){this.__data__=[]}function hr(r){var i=this.__data__,s=q(i,r);if(s<0)return!1;var d=i.length-1;return s==d?i.pop():Vt.call(i,s,1),!0}function dr(r){var i=this.__data__,s=q(i,r);return s<0?void 0:i[s][1]}function ur(r){return q(this.__data__,r)>-1}function pr(r,i){var s=this.__data__,d=q(s,r);return d<0?s.push([r,i]):s[d][1]=i,this}b.prototype.clear=lr,b.prototype.delete=hr,b.prototype.get=dr,b.prototype.has=ur,b.prototype.set=pr;function I(r){var i=-1,s=r?r.length:0;for(this.clear();++i<s;){var d=r[i];this.set(d[0],d[1])}}function fr(){this.__data__={hash:new C,map:new(R||b),string:new C}}function yr(r){return z(this,r).delete(r)}function gr(r){return z(this,r).get(r)}function Sr(r){return z(this,r).has(r)}function wr(r,i){return z(this,r).set(r,i),this}I.prototype.clear=fr,I.prototype.delete=yr,I.prototype.get=gr,I.prototype.has=Sr,I.prototype.set=wr;function k(r){this.__data__=new b(r)}function mr(){this.__data__=new b}function br(r){return this.__data__.delete(r)}function _r(r){return this.__data__.get(r)}function xr(r){return this.__data__.has(r)}function Er(r,i){var s=this.__data__;if(s instanceof b){var d=s.__data__;if(!R||d.length<a-1)return d.push([r,i]),this;s=this.__data__=new I(d)}return s.set(r,i),this}k.prototype.clear=mr,k.prototype.delete=br,k.prototype.get=_r,k.prototype.has=xr,k.prototype.set=Er;function vr(r,i){var s=le(r)||Wr(r)?Gt(r.length,String):[],d=s.length,g=!!d;for(var S in r)E.call(r,S)&&!(g&&(S=="length"||Mr(S,d)))&&s.push(S);return s}function it(r,i,s){var d=r[i];(!(E.call(r,i)&&lt(d,s))||s===void 0&&!(i in r))&&(r[i]=s)}function q(r,i){for(var s=r.length;s--;)if(lt(r[s][0],i))return s;return-1}function Ar(r,i){return r&&st(i,he(i),r)}function oe(r,i,s,d,g,S,_){var w;if(d&&(w=S?d(r,g,S,_):d(r)),w!==void 0)return w;if(!W(r))return r;var ut=le(r);if(ut){if(w=jr(r),!i)return Fr(r,w)}else{var $=N(r),pt=$==A||$==Ie;if(Vr(r))return Dr(r,i);if($==Z||$==h||pt&&!S){if(We(r))return S?r:{};if(w=Gr(pt?{}:r),!i)return Br(r,Ar(w,r))}else{if(!f[$])return S?r:{};w=Hr(r,$,oe,i)}}_||(_=new k);var ft=_.get(r);if(ft)return ft;if(_.set(r,w),!ut)var yt=s?Jr(r):he(r);return Jt(yt||r,function(de,Y){yt&&(Y=de,de=r[Y]),it(w,Y,oe(de,i,s,d,Y,r,_))}),w}function Cr(r){return W(r)?Wt(r):{}}function Nr(r,i,s){var d=i(r);return le(r)?d:jt(d,s(r))}function Tr(r){return U.call(r)}function Ir(r){if(!W(r)||qr(r))return!1;var i=dt(r)||We(r)?qt:Ot;return i.test(T(r))}function kr(r){if(!ct(r))return Qt(r);var i=[];for(var s in Object(r))E.call(r,s)&&s!="constructor"&&i.push(s);return i}function Dr(r,i){if(i)return r.slice();var s=new r.constructor(r.length);return r.copy(s),s}function ce(r){var i=new r.constructor(r.byteLength);return new tt(i).set(new tt(r)),i}function $r(r,i){var s=i?ce(r.buffer):r.buffer;return new r.constructor(s,r.byteOffset,r.byteLength)}function Or(r,i,s){var d=i?s(Ye(r),!0):Ye(r);return ze(d,Ft,new r.constructor)}function Kr(r){var i=new r.constructor(r.source,$t.exec(r));return i.lastIndex=r.lastIndex,i}function Pr(r,i,s){var d=i?s(Ve(r),!0):Ve(r);return ze(d,Bt,new r.constructor)}function Rr(r){return nt?Object(nt.call(r)):{}}function Lr(r,i){var s=i?ce(r.buffer):r.buffer;return new r.constructor(s,r.byteOffset,r.length)}function Fr(r,i){var s=-1,d=r.length;for(i||(i=Array(d));++s<d;)i[s]=r[s];return i}function st(r,i,s,d){s||(s={});for(var g=-1,S=i.length;++g<S;){var _=i[g],w=void 0;it(s,_,w===void 0?r[_]:w)}return s}function Br(r,i){return st(r,ot(r),i)}function Jr(r){return Nr(r,he,ot)}function z(r,i){var s=r.__data__;return Ur(i)?s[typeof i=="string"?"string":"hash"]:s.map}function D(r,i){var s=Ht(r,i);return Ir(s)?s:void 0}var ot=rt?te(rt,Object):Zr,N=Tr;(ae&&N(new ae(new ArrayBuffer(1)))!=H||R&&N(new R)!=j||ne&&N(ne.resolve())!=De||ie&&N(new ie)!=G||se&&N(new se)!=ee)&&(N=function(r){var i=U.call(r),s=i==Z?r.constructor:void 0,d=s?T(s):void 0;if(d)switch(d){case Zt:return H;case er:return j;case tr:return De;case rr:return G;case ar:return ee}return i});function jr(r){var i=r.length,s=r.constructor(i);return i&&typeof r[0]=="string"&&E.call(r,"index")&&(s.index=r.index,s.input=r.input),s}function Gr(r){return typeof r.constructor=="function"&&!ct(r)?Cr(zt(r)):{}}function Hr(r,i,s,d){var g=r.constructor;switch(i){case Pe:return ce(r);case p:case y:return new g(+r);case H:return $r(r,d);case Re:case Le:case Fe:case Be:case Je:case je:case Ge:case He:case Me:return Lr(r,d);case j:return Or(r,d,s);case ke:case Oe:return new g(r);case $e:return Kr(r);case G:return Pr(r,d,s);case Ke:return Rr(r)}}function Mr(r,i){return i=i??o,!!i&&(typeof r=="number"||Kt.test(r))&&r>-1&&r%1==0&&r<i}function Ur(r){var i=typeof r;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?r!=="__proto__":r===null}function qr(r){return!!Xe&&Xe in r}function ct(r){var i=r&&r.constructor,s=typeof i=="function"&&i.prototype||M;return r===s}function T(r){if(r!=null){try{return Qe.call(r)}catch{}try{return r+""}catch{}}return""}function zr(r){return oe(r,!0,!0)}function lt(r,i){return r===i||r!==r&&i!==i}function Wr(r){return Yr(r)&&E.call(r,"callee")&&(!Yt.call(r,"callee")||U.call(r)==h)}var le=Array.isArray;function ht(r){return r!=null&&Xr(r.length)&&!dt(r)}function Yr(r){return Qr(r)&&ht(r)}var Vr=Xt||ea;function dt(r){var i=W(r)?U.call(r):"";return i==A||i==Ie}function Xr(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=o}function W(r){var i=typeof r;return!!r&&(i=="object"||i=="function")}function Qr(r){return!!r&&typeof r=="object"}function he(r){return ht(r)?vr(r):kr(r)}function Zr(){return[]}function ea(){return!1}e.exports=zr}(F,F.exports)),F.exports}var we,Et;function ua(){if(Et)return we;Et=1;const e=da();function t(a={},n={},o=!0){if(typeof a!="object"){if(o)throw new Error("Assign Function: The target provided is not an object");return null}if(typeof n!="object"){if(o)throw new Error("Assign Function: The source provided is not an object");return null}try{return Object.assign(e(a),e(n))}catch(h){if(o)throw h}}return we=t,we}var pa=ua();const X=J(pa);globalThis.storagefyDebug=!1;globalThis.storagefyDebugLevel=0;var l=(...e)=>{globalThis.storagefyDebug&&globalThis.storagefyDebugLevel>=0&&(e.unshift("Storagefy Error:"),console.error(...e))},kt=(...e)=>{globalThis.storagefyDebug&&globalThis.storagefyDebugLevel>=1&&(e.unshift("Storagefy Warn:"),console.warn(...e))},c=(...e)=>{globalThis.storagefyDebug&&globalThis.storagefyDebugLevel>=2&&(e.unshift("Storagefy:"),console.info(...e))},Ae=new TextEncoder,fa=new TextDecoder,B,O;function ya(){try{if(c("CryptoHelper - Attempting to initialize crypto engine"),typeof window<"u"&&window.crypto){B=window.crypto,O=B.subtle,c("CryptoHelper - Crypto initialized from window.crypto");return}if(typeof global<"u"&&global.crypto?.webcrypto){B=global.crypto.webcrypto,O=B.subtle,c("CryptoHelper - Crypto initialized from global.webcrypto");return}throw new Error("Crypto API not available")}catch(e){throw l("Failed to initialize crypto:",e),e}}try{ya()}catch(e){l("Failed to initialize crypto:",e)}var ga=async e=>{try{return c("CryptoHelper - Generating key material from password"),O.importKey("raw",Ae.encode(e),"PBKDF2",!1,["deriveKey"])}catch(t){throw l("Error generating key material:",t),t}},vt=async(e,t,a=!1)=>{try{if(typeof e!="string"||!e.length)throw new Error("Invalid password");c("CryptoHelper - Deriving key with PBKDF2",{passwordLength:e.length,extractable:a});let n=await ga(e);return O.deriveKey({name:"PBKDF2",salt:Ae.encode(t),iterations:1e5,hash:"SHA-256"},n,{name:"AES-GCM",length:256},a,["encrypt","decrypt"])}catch(n){throw l("Error deriving key:",n),n}},Sa=async(e,t,a=!1)=>{if(t===void 0||typeof t=="function"||typeof t=="symbol")throw new Error("Invalid data type for encryption");try{c("CryptoHelper - Encrypting data",{raw:a});let n=B.getRandomValues(new Uint8Array(12)),o=Ae.encode(JSON.stringify(t)),h=await O.encrypt({name:"AES-GCM",iv:n},e,o);if(a)return{iv:n,data:new Uint8Array(h)};let u=_e(String.fromCharCode(...n)),p=_e(String.fromCharCode(...new Uint8Array(h)));return{iv:u,data:p}}catch(n){throw l("Error encrypting data:",n),n}},wa=async(e,t,a=!1)=>{let n,o;try{if(c("CryptoHelper - Decrypting data",{raw:a}),a)n=new Uint8Array(t.iv),o=new Uint8Array(t.data);else{let u=p=>new Uint8Array(It(p).split("").map(y=>y.charCodeAt(0)));n=u(t.iv),o=u(t.data)}let h=await O.decrypt({name:"AES-GCM",iv:n},e,o);return JSON.parse(fa.decode(h))}catch(h){throw l("Error decrypting data:",h),h}};function ma(e){if(!e)return e;c("CryptoHelper - Obfuscating string");try{let t=[...e].map(a=>String.fromCharCode(a.charCodeAt(0)+1)).join("");return _e(t)}catch{return e}}function Ce(e){if(!e)return e;c("CryptoHelper - Deobfuscating string");try{return[...It(e)].map(t=>String.fromCharCode(t.charCodeAt(0)-1)).join("")}catch{return e}}var ba=class{constructor(e){try{typeof e!="string"&&(e=Q("storagefy_channel")),this.channel=new BroadcastChannel(e),this.channelName=e,c(`CrossTabChannel initialized on channel "${e}"`)}catch(t){throw l("Failed to initialize BroadcastChannel:",t),t}}subscribe(e){if(typeof e!="function"){kt("CrossTabChannel.subscribe: Provided callback is not a function.");return}this.channel.onmessage=t=>{c("CrossTabChannel - Received message:",t.data);try{e(t.data)}catch(a){l("Error in CrossTabChannel subscriber callback:",a)}},c("CrossTabChannel - Subscribed to incoming messages.")}emit(e){try{this.channel.postMessage(e),c("CrossTabChannel - Emitted message:",e)}catch(t){l("CrossTabChannel.emit: Failed to send message:",t)}}close(){try{this.channel.close(),c("CrossTabChannel - Channel closed.")}catch(e){l("CrossTabChannel.close: Error closing channel:",e)}}},_a=ba,xa=class{constructor(e){e?(c("StorageAdapter - Initializing cross-tab channel:",e),this.channelName=e,this.channel=new _a(e)):(this.channel=null,this.channelName=null,kt("StorageAdapter - No channel name provided, cross-tab syncing disabled."))}async get(e){throw new Error("Not implemented")}async set(e,t,a){throw new Error("Not implemented")}async delete(e){throw new Error("Not implemented")}async list(e=""){throw new Error("Not implemented")}async reset(){throw new Error("Not implemented")}async clear(){throw new Error("Not implemented")}async clearExpire(){throw new Error("Not implemented")}async setExpire(e,t){throw new Error("Not implemented")}async deleteExpire(e){throw new Error("Not implemented")}async has(e){throw new Error("Not implemented")}async _encrypt(e,t){if(!this.encrypt||!e)return t;try{let a=await vt(e),n=await Sa(a,t,!1);return c(`StorageAdapter - Successfully encrypted value for key "${e}".`),JSON.stringify(n)}catch(a){return l("Encryption failed:",a),null}}async _decrypt(e,t){if(!this.encrypt||!e)return JSON.parse(t);try{let a=await vt(e),n=JSON.parse(t),o=await wa(a,n,!1);return c(`StorageAdapter - Successfully decrypted value for key "${e}".`),JSON.parse(o)}catch(a){return l("Decryption failed:",a),null}}_fullKey(e){let t=`${this.prefix}${e}`;if(this.encrypt){let a=ma(t);return c(`StorageAdapter - Obfuscated key "${e}" to "${a}".`),a}return c(`StorageAdapter - Using plain key: "${t}"`),t}_startExpireWatcher(){this._expireTimer&&clearInterval(this._expireTimer),!(this.expireCheckInterval<=0)&&(this._expireTimer=setInterval(()=>{try{c("StorageAdapter - Running expiration cleanup..."),this.clearExpire()}catch(e){l("Error clearing expired keys:",e)}},this.expireCheckInterval),c(`StorageAdapter - Expire watcher started, interval: ${this.expireCheckInterval}ms`))}destroy(){this._expireTimer&&(clearInterval(this._expireTimer),this._expireTimer=null,c("StorageAdapter - Expire watcher stopped.")),this._unloadHandler&&(window.removeEventListener("beforeunload",this._unloadHandler),this._unloadHandler=null,c("StorageAdapter - Removed unload handler."))}async getAll(e){return c(`StorageAdapter - Getting all keys under table: "${e}"`),this.list(`${e}__`)}async getExpire(e){try{let t=await this._loadExpires();return c(`StorageAdapter - Getting expiration for key "${e}":`,t[e]||null),t[e]||null}catch(t){return l(`Error getting expire for key '${e}':`,t),null}}emitDataChange(e,t,a){!this.channelName||!a||(c(`StorageAdapter - Emitting data change for key "${e}" from origin "${a}"`),this.channel.emit({adapterId:this.adapterId,key:e,value:t,origin:a}))}onDataChanged(e){!this.channelName||typeof e!="function"||(c("StorageAdapter - Subscribing to cross-tab data changes."),this.channel.subscribe(e))}},Ne=xa,Ea=class extends Ne{constructor({dbName:e,storeName:t,version:a=1,encrypt:n=!1,expireCheckInterval:o=1e3,channelName:h=!1,enableSyncTabs:u=!1,description:p=""}){if(super(h),typeof indexedDB>"u")throw l("IndexedDB is not available in this environment"),new Error("IndexedDB is not available in this environment");this.isReady=!1,this.dbName=e,this.storeName=t||`${e}_store`,this.encrypt=n,this.expireKey=`STRGF_${e}__expires`,this.metaKey=`STRGF_${e}__meta`,this.prefix=`${e}__`,this.adapterId=Q(e),this.enableSyncTabs=u||!1,this.expireCheckInterval=o,this.dbPromise=null,this._initDB({dbName:e,version:a,description:p}),this._startExpireWatcher(),this._unloadHandler=()=>this.destroy(),window.addEventListener("beforeunload",this._unloadHandler),c(`IndexedDBAdapter - initialized with dbName: ${e}, storeName: ${this.storeName}`)}_initDB({dbName:e,version:t,description:a}){c(`IndexedDBAdapter -Initializing IndexedDB with dbName: ${e}, storeName: ${this.storeName}`),this.dbPromise=new Promise((n,o)=>{let h=indexedDB.open(e,t);h.onupgradeneeded=u=>{let p=u.target.result;p.objectStoreNames.contains(this.storeName)||p.createObjectStore(this.storeName);let y={dbName:e,version:t,description:a,createdAt:Date.now()};u.target.transaction.objectStore(this.storeName).put(JSON.stringify(y),this.metaKey)},h.onsuccess=u=>{let p=u.target.result,y=p.transaction(this.storeName,"readwrite").objectStore(this.storeName),P=y.get(this.metaKey);P.onsuccess=()=>{if(!P.result){let A={dbName:e,version:t,description:a,createdAt:Date.now()};y.put(JSON.stringify(A),this.metaKey)}this.isReady=!0,n(p)},P.onerror=A=>{l("Error checking meta:",A),n(p)}},h.onerror=u=>{l("Error opening database:",u.target.error),o(u.target.error)}})}async waitReadiness(e=50,t=20){return c(`IndexedDBAdapter - Waiting for database readiness with timeout: ${e}ms, tries: ${t}`),new Promise(async(a,n)=>{try{if(await ha(e),this.isReady)return a(),!0;let o=0;for(;!this.isReady&&o++<t;)setTimeout(()=>{if(this.isReady)return a(),!0},e)}catch(o){return n(o)}n(new Error("Database is not ready"))})}async _withStore(e,t){try{c(`IndexedDBAdapter - Executing operation in ${e} mode`);let a=(await this.dbPromise).transaction(this.storeName,e).objectStore(this.storeName);return await t(a)}catch(a){throw l("Database operation failed:",a),a}}async _loadExpires(){return c("IndexedDBAdapter - Loading expiration timestamps"),this._withStore("readonly",async e=>new Promise(t=>{let a=e.get(this.expireKey);a.onsuccess=()=>{t(a.result?JSON.parse(a.result):{})},a.onerror=()=>{t({})}}))}async get(e){try{c(`IndexedDBAdapter - Getting key: ${e}`);let t=this._fullKey(e),a=await this._withStore("readonly",o=>new Promise(h=>{let u=o.get(t);u.onsuccess=()=>h(u.result),u.onerror=()=>h(null)}));if(!a)return null;let n=await this.getExpire(e);return n&&Date.now()>=n?(await this.delete(e),null):await this._decrypt(e,a)}catch(t){return l(`Error getting key '${e}':`,t),null}}async set(e,t,a){try{if(c(`IndexedDBAdapter - Setting key: ${e}`,{value:t,expire:a}),!e&&!t)return!1;let n=this._fullKey(e);if(e&&t==null)return await this.delete(n),null;t=JSON.stringify(t);let o=await this._encrypt(e,t);return o?(await this._withStore("readwrite",h=>new Promise(u=>{let p=h.put(o,n);p.onsuccess=()=>{this.enableSyncTabs&&this.emitDataChange(e,void 0,"reset"),u(!0)},p.onerror=()=>u(!1)})),typeof a!="number"?(await this.deleteExpire(e),!0):a>0?(await this.setExpire(e,Date.now()+a),!0):(await this.delete(e),null)):!1}catch(n){return l(`Error setting key '${e}':`,n),!1}}async delete(e){try{c(`IndexedDBAdapter - Deleting key: ${e}`);let t=this._fullKey(e);await this._withStore("readwrite",n=>new Promise(o=>{let h=n.delete(t);h.onsuccess=()=>{this.enableSyncTabs&&this.emitDataChange(e,void 0,"reset"),o(!0)},h.onerror=()=>o()}));let a=await this._loadExpires();delete a[e],await this._withStore("readwrite",n=>new Promise(o=>{let h=n.put(JSON.stringify(a),this.expireKey);h.onsuccess=()=>o(),h.onerror=()=>o()}))}catch(t){l(`Error deleting key '${e}':`,t)}}async list(){let e=[];try{c(`IndexedDBAdapter - Listing keys with prefix: ${this.prefix}`),await this._withStore("readonly",async t=>new Promise(a=>{let n=t.getAllKeys();n.onsuccess=async()=>{let o=n.result||[];for(let h of o)if(this.encrypt&&(h=Ce(h)),!(h===this.metaKey||h===this.expireKey)&&h.startsWith(this.prefix)){let u=await this.get(h.replace(this.prefix,""));u!==null&&e.push({key:h.replace(this.prefix,""),value:u})}a()},n.onerror=()=>a()}))}catch(t){l("Error listing keys:",t)}return e}async has(e){try{c(`IndexedDBAdapter - Checking existence of key: ${e}`);let t=this._fullKey(e);return await this._withStore("readonly",a=>new Promise(n=>{let o=a.getKey(t);o.onsuccess=()=>n(o.result!==void 0),o.onerror=()=>n(!1)}))}catch(t){return l(`Error checking key '${e}':`,t),!1}}async clear(){try{c("IndexedDBAdapter - Clearing all data"),await this.reset(),await this._withStore("readwrite",e=>new Promise(t=>{let a=e.delete(this.metaKey);a.onsuccess=()=>{let n=e.delete(this.expireKey);n.onsuccess=()=>t(),n.onerror=()=>t()},a.onerror=()=>t()}))}catch(e){l("Error clearing storage:",e)}}async reset(){try{c("IndexedDBAdapter - Resetting storage"),await this._withStore("readwrite",async e=>new Promise(t=>{let a=e.getAllKeys();a.onsuccess=()=>{let n=a.result||[];if(n.length===0){t();return}let o=0,h=u=>()=>{++o===n.length&&(this.enableSyncTabs&&this.emitDataChange(u.replace(this.prefix,""),"reset"),t())};for(let u of n){let p=e.delete(u);p.onsuccess=h(u),p.onerror=h(u)}},a.onerror=()=>t()}))}catch(e){l("Error resetting storage:",e)}}async setExpire(e,t){try{c(`IndexedDBAdapter - Setting expire for key: ${e}, timestamp: ${t}`);let a=await this._loadExpires();a[e]=t,await this._withStore("readwrite",n=>new Promise(o=>{let h=n.put(JSON.stringify(a),this.expireKey);h.onsuccess=()=>o(),h.onerror=()=>o()}))}catch(a){l(`Error setting expire for key '${e}':`,a)}}async deleteExpire(e){try{c(`IndexedDBAdapter - Deleting expire for key: ${e}`);let t=await this._loadExpires();delete t[e],await this._withStore("readwrite",a=>new Promise(n=>{let o=a.put(JSON.stringify(t),this.expireKey);o.onsuccess=()=>n(),o.onerror=()=>n()}))}catch(t){l(`Error deleting expire for key '${e}':`,t)}}async clearExpire(){try{c("IndexedDBAdapter - Clearing expired keys");let e=Date.now(),t=await this._loadExpires(),a=!1;for(let n in t)t[n]<=e&&(await this.delete(n),a=!0);if(a){let n=await this._loadExpires();await this._withStore("readwrite",o=>new Promise(h=>{let u=o.put(JSON.stringify(n),this.expireKey);u.onsuccess=()=>h(),u.onerror=()=>h()}))}}catch(e){l("Error clearing expired keys:",e)}}},xe=Ea,va=class extends Ne{constructor({dbName:e,version:t=1,encrypt:a=!1,expireCheckInterval:n=1e3,description:o="",channelName:h=!1,enableSyncTabs:u=!1}){if(super(h),typeof localStorage>"u")throw l("LocalStorage is not available in this environment"),new Error("LocalStorage is not available in this environment");this.dbName=e,this.encrypt=a,this.expireKey=`STRGF_${e}__expires`,this.metaKey=`STRGF_${e}__meta`,this.prefix=`${e}__`,this.adapterId=Q(e),this.expireCheckInterval=n,this.enableSyncTabs=u||!1,this._initMeta({dbName:e,version:t,description:o}),this._startExpireWatcher(),this._unloadHandler=()=>this.destroy(),window.addEventListener("beforeunload",this._unloadHandler),c(`LocalStorageAdapter -  initialized with dbName: ${e}, version: ${t}, encrypt: ${a}, description: ${o}`)}_initMeta({dbName:e,version:t,description:a}){try{c("LocalStorageAdapter - Initializing metadata for LocalStorageAdapter");let n={dbName:e,version:t,description:a,createdAt:Date.now()};localStorage.setItem(this.metaKey,JSON.stringify(n))}catch(n){l("Error initializing meta:",n)}}_loadExpires(){try{c("LocalStorageAdapter - Loading expiration metadata");let e=localStorage.getItem(this.expireKey);return e?JSON.parse(e):{}}catch(e){return l("Error loading expires:",e),{}}}async get(e){try{c(`LocalStorageAdapter - Getting key: ${e}`);let t=this._fullKey(e),a=localStorage.getItem(t);if(!a)return null;let n=await this.getExpire(e);return n&&Date.now()>=n?(await this.delete(e),null):await this._decrypt(e,a)}catch(t){return l(`Error getting key '${e}':`,t),null}}async set(e,t,a){try{if(c(`LocalStorageAdapter - Setting key: ${e}`,{value:t,expire:a}),!e&&!t)return!1;let n=this._fullKey(e);if(e&&t==null)return await this.delete(n),null;t=JSON.stringify(t);let o=await this._encrypt(e,t);return o?(localStorage.setItem(n,o),this.enableSyncTabs&&this.emitDataChange(e,void 0,"set"),typeof a!="number"?(await this.deleteExpire(e),!0):a>0?(await this.setExpire(e,Date.now()+a),!0):(await this.delete(e),null)):!1}catch(n){return l(`Error setting key '${e}':`,n),!1}}async delete(e){try{c(`LocalStorageAdapter - Deleting key: ${e}`);let t=this._fullKey(e);localStorage.removeItem(t);let a=this._loadExpires();delete a[e],localStorage.setItem(this.expireKey,JSON.stringify(a)),this.enableSyncTabs&&this.emitDataChange(e,void 0,"delete")}catch(t){l(`Error deleting key '${e}':`,t)}}async list(){let e=[];c(`LocalStorageAdapter - Listing keys with prefix: ${this.prefix}`);try{for(let t=0;t<localStorage.length;t++){let a=localStorage.key(t);if(this.encrypt&&(a=Ce(a)),!(a===this.metaKey||a===this.expireKey)&&a.startsWith(this.prefix)){let n=await this.get(a.replace(this.prefix,""));n!==null&&e.push({key:a.replace(this.prefix,""),value:n})}}}catch(t){throw l("Error listing keys:",t),t}return e}async has(e){try{c(`LocalStorageAdapter - Checking existence of key: ${e}`);let t=this._fullKey(e);return localStorage.getItem(t)!==null}catch(t){return l(`Error checking key '${e}':`,t),!1}}async clear(){try{c("LocalStorageAdapter - Clearing all data"),await this.reset(),localStorage.removeItem(this.metaKey),localStorage.removeItem(this.expireKey)}catch(e){l("Error clearing storage:",e)}}async reset(){try{c("LocalStorageAdapter - Resetting storage");let e=[];for(let t=0;t<localStorage.length;t++){let a=localStorage.key(t);a.startsWith(this.prefix)&&e.push(a)}for(let t of e)localStorage.removeItem(t),this.enableSyncTabs&&this.emitDataChange(t.replace(this.prefix,""),void 0,"reset")}catch(e){l("Error resetting storage:",e)}}async setExpire(e,t){try{c(`LocalStorageAdapter - Setting expiration for key: ${e}`,{timestamp:t});let a=this._loadExpires();a[e]=t,localStorage.setItem(this.expireKey,JSON.stringify(a))}catch(a){l(`Error setting expire for key '${e}':`,a)}}async deleteExpire(e){try{c(`LocalStorageAdapter - Deleting expiration for key: ${e}`);let t=this._loadExpires();delete t[e],localStorage.setItem(this.expireKey,JSON.stringify(t))}catch(t){l(`Error deleting expire for key '${e}':`,t)}}async clearExpire(){try{c("LocalStorageAdapter - Clearing expired keys");let e=Date.now(),t=this._loadExpires(),a=!1;for(let n in t)t[n]<=e&&(await this.delete(n),a=!0);a&&localStorage.setItem(this.expireKey,JSON.stringify(this._loadExpires()))}catch(e){l("Error clearing expired keys:",e)}}},Ee=va,Aa=class extends Ne{constructor({dbName:e,version:t=1,encrypt:a=!1,expireCheckInterval:n=1e3,channelName:o=!1,description:h="",enableSyncTabs:u=!1}){if(super(o),typeof sessionStorage>"u")throw l("SessionStorage is not available in this environment"),new Error("SessionStorage is not available in this environment");this.dbName=e,this.encrypt=a,this.expireKey=`STRGF_${e}__expires`,this.metaKey=`STRGF_${e}__meta`,this.prefix=`${e}__`,this.adapterId=Q(e),this.expireCheckInterval=n,this.enableSyncTabs=u||!1,this._initMeta({dbName:e,version:t,description:h}),this._startExpireWatcher(),this._unloadHandler=()=>this.destroy(),window.addEventListener("beforeunload",this._unloadHandler),c(`SessionStorageAdapter - initialized with prefix: ${this.prefix}, encrypt: ${this.encrypt}`)}_initMeta({dbName:e,version:t,description:a}){try{c(`SessionStorageAdapter - Initializing metadata for ${e} v${t}`);let n={dbName:e,version:t,description:a,createdAt:Date.now()};sessionStorage.setItem(this.metaKey,JSON.stringify(n))}catch(n){l("Error initializing meta:",n)}}_loadExpires(){try{c("SessionStorageAdapter - Loading expiration map");let e=sessionStorage.getItem(this.expireKey);return e?JSON.parse(e):{}}catch(e){return l("Error loading expires:",e),{}}}async get(e){try{c(`SessionStorageAdapter - Getting key '${e}'`);let t=this._fullKey(e),a=sessionStorage.getItem(t);if(!a)return null;let n=await this.getExpire(e);return n&&Date.now()>=n?(await this.delete(e),null):await this._decrypt(e,a)}catch(t){return l(`Error getting key '${e}':`,t),null}}async set(e,t,a){try{if(c(`SessionStorageAdapter - Setting key: ${e}`,{value:t,expire:a}),!e&&!t)return!1;let n=this._fullKey(e);if(e&&t==null)return await this.delete(n),null;t=JSON.stringify(t);let o=await this._encrypt(e,t);return o?(sessionStorage.setItem(n,o),this.enableSyncTabs&&this.emitDataChange(e,o,"set"),typeof a!="number"?(await this.deleteExpire(e),!0):a>0?(await this.setExpire(e,Date.now()+a),!0):(await this.delete(e),null)):!1}catch(n){return l(`Error setting key '${e}':`,n),!1}}async delete(e){try{c(`SessionStorageAdapter - Deleting key '${e}'`);let t=this._fullKey(e);sessionStorage.removeItem(t);let a=this._loadExpires();delete a[e],sessionStorage.setItem(this.expireKey,JSON.stringify(a)),this.enableSyncTabs&&this.emitDataChange(e,void 0,"delete")}catch(t){l(`Error deleting key '${e}':`,t)}}async list(){let e=[];try{c(`SessionStorageAdapter - Listing keys with prefix '${this.prefix}'`);for(let t=0;t<sessionStorage.length;t++){let a=sessionStorage.key(t);if(this.encrypt&&(a=Ce(a)),!(a===this.metaKey||a===this.expireKey)&&a.startsWith(this.prefix)){let n=await this.get(a.replace(this.prefix,""));n!==null&&e.push({key:a.replace(this.prefix,""),value:n})}}}catch(t){throw l("Error listing keys:",t),t}return e}async has(e){try{c(`SessionStorageAdapter - Checking existence of key '${e}'`);let t=this._fullKey(e);return sessionStorage.getItem(t)!==null}catch(t){return l(`Error checking key '${e}':`,t),!1}}async clear(){try{c("SessionStorageAdapter - Clearing all data"),await this.reset(),sessionStorage.removeItem(this.metaKey),sessionStorage.removeItem(this.expireKey)}catch(e){l("Error clearing storage:",e)}}async reset(){try{c("SessionStorageAdapter - Resetting storage");let e=[];for(let t=0;t<sessionStorage.length;t++){let a=sessionStorage.key(t);a.startsWith(this.prefix)&&e.push(a)}for(let t of e)sessionStorage.removeItem(t),this.enableSyncTabs&&this.emitDataChange(t.replace(this.prefix,""),void 0,"reset")}catch(e){l("Error resetting storage:",e)}}async setExpire(e,t){try{c(`SessionStorageAdapter - Setting expire for key '${e}'`);let a=this._loadExpires();a[e]=t,sessionStorage.setItem(this.expireKey,JSON.stringify(a))}catch(a){l(`Error setting expire for key '${e}':`,a)}}async deleteExpire(e){try{c(`SessionStorageAdapter - Deleting expire for key '${e}'`);let t=this._loadExpires();delete t[e],sessionStorage.setItem(this.expireKey,JSON.stringify(t))}catch(t){l(`Error deleting expire for key '${e}':`,t)}}async clearExpire(){try{c("SessionStorageAdapter - Clearing expired keys");let e=Date.now(),t=this._loadExpires(),a=!1;for(let n in t)t[n]<=e&&(await this.delete(n),a=!0);a&&sessionStorage.setItem(this.expireKey,JSON.stringify(this._loadExpires()))}catch(e){l("Error clearing expired keys:",e)}}},ve=Aa,Ca=class{async setInStorage(e,t,a={}){throw new Error("Not implemented")}async getFromStorage(e,t,a){throw new Error("Not implemented")}destroy(){if(this._unsubscribe){c("StoreAdapter - destroy - Unsubscribing from store changes."),this._unsubscribe(),this._unsubscribe=null;return}c("StoreAdapter - destroy - No unsubscribe function to call.")}},Te=Ca,Na=class extends Te{constructor(e){if(super(),!e)throw l("Adapter provided is not defined"),new Error("Adapter provided is not defined");this.adapter=e}_checkStore(e){if(!e||!e.$subscribe||!e.$patch)throw l("Store provided is not defined"),new Error("Store provided is not defined")}_registerOnDataChanged(e){c("PiniaAdapter - Registering onDataChanged listener"),e&&this.adapter.onDataChanged(async t=>{try{if(t.adapterId==this.adapter.adapterId||!t.origin)return;let a;if(t.value?a=await this.adapter._decrypt(t.key,t.value):a=await this.adapter.get(t.key),JSON.stringify(e.$state)===JSON.stringify(a))return;e.$state={...e.$state,...a,STORAGEFY_SILENT_CHANNEL_UPDATE:!0}}catch(a){l("PiniaAdapter - onDataChanged - error:",a)}})}async setInStorage(e,t,a={}){try{return c("PiniaAdapter - setInStorage - key:",t),this._checkStore(e),a.ignoreKeys=a.ignoreKeys||[],this._unsubscribe&&this._unsubscribe(),new Promise((n,o)=>{this._unsubscribe=e.$subscribe(async(h,u)=>{try{if(!u)return n(!0);if(u.STORAGEFY_SILENT_CHANNEL_UPDATE)return delete u.STORAGEFY_SILENT_CHANNEL_UPDATE,n(!0);let p={...u};for(let y in p)a.ignoreKeys.includes(y)&&(p[y]=void 0);return await this.adapter.set(t,p,a.timeout),n(!0)}catch(p){return o(p)}}),e.$patch({...e.$state}),a.syncTabs&&this._registerOnDataChanged(e)})}catch(n){throw l(n),n}}async getFromStorage(e,t){try{c("PiniaAdapter - getFromStorage - key:",t),this._checkStore(e);let a=await this.adapter.get(t);return a?(e.$patch(X({},a)),!0):void 0}catch(a){throw l(a),a}}},At=Na,Ta=class extends Te{constructor(e){if(super(),!e)throw l("Adapter provided is not defined"),new Error("Adapter provided is not defined");this.adapter=e,this._unsubscribe=null}_getPayload(e,t){return{...e,...t,STORAGEFY_SILENT_CHANNEL_UPDATE:!0}}_registerOnDataChanged(e){c("ReactAdapter - Registering onDataChanged listener"),e&&this.adapter.onDataChanged(async t=>{try{if(t.adapterId==this.adapter.adapterId||!t.origin)return;let a;if(t.value?a=await this.adapter._decrypt(t.key,t.value):a=await this.adapter.get(t.key),typeof e.dispatch=="function"&&typeof e.getState=="function"){let o=e.getState();if(JSON.stringify(o)===JSON.stringify(a))return;e.dispatch({type:"STORAGEFY_UPDATE",payload:this._getPayload(o,a)});return}if(typeof e.getState=="function"&&typeof e.setState=="function"){let o=e.getState();if(JSON.stringify(o)===JSON.stringify(a))return;e.setState(this._getPayload(o,a));return}if(typeof e.set=="function"&&typeof e.get=="function"){let o=e.get();if(JSON.stringify(o)===JSON.stringify(a))return;e.set(this._getPayload(o,a));return}if(typeof e.update=="function"){e.update(o=>JSON.stringify(o)===JSON.stringify(a)?o:this._getPayload(o,a));return}let n=typeof e.getState=="function"?e.getState():typeof e.get=="function"?e.get():{};if(JSON.stringify(n)===JSON.stringify(a))return;typeof e.set=="function"?e.set(this._getPayload(n,a)):l("Unable to update store: No compatible update method found")}catch(a){l("Error in _registerOnDataChanged:",a)}})}async setInStorage(e,t,a={}){try{return c("ReactAdapter - setInStorage - key:",t),this._checkStore(e),a.ignoreKeys=a.ignoreKeys||[],this._unsubscribe&&this._unsubscribe(),new Promise((n,o)=>{let h=async u=>{try{if(!u)return;if(u.STORAGEFY_SILENT_CHANNEL_UPDATE)return delete u.STORAGEFY_SILENT_CHANNEL_UPDATE,n(!0);let p={...u};for(let y in p)a.ignoreKeys.includes(y)&&(p[y]=void 0);await this.adapter.set(t,p,a.timeout)}catch(p){l(p)}};if(typeof e.subscribe=="function"&&typeof e.getState=="function")h(e.getState()),this._unsubscribe=e.subscribe(()=>{h(e.getState())});else if(typeof e.subscribe=="function")this._unsubscribe=e.subscribe(h);else{o(new Error("Unsupported store type"));return}a.syncTabs&&this._registerOnDataChanged(e),n(!0)})}catch(n){throw l(n),n}}async getFromStorage(e,t){try{c("ReactAdapter - getFromStorage - key:",t),this._checkStore(e);let a=await this.adapter.get(t);if(!a)return;if(typeof e.dispatch=="function")e.dispatch({type:"SET_STATE_FROM_STORAGE",payload:a});else if(typeof e.setState=="function")e.setState(X({},a));else throw new Error("Cannot update store: setState or dispatch method not found");return!0}catch(a){throw l(a),a}}_checkStore(e){if(!e)throw l("Store provided is not defined"),new Error("Store provided is not defined");if(typeof e.getState=="function"&&typeof e.dispatch=="function"&&typeof e.subscribe=="function"||typeof e.getState=="function"&&typeof e.setState=="function"&&typeof e.subscribe=="function"||(console.log("STORE>>",e),Array.isArray(e)&&e.length===2&&typeof e[0]=="function"&&typeof e[1]=="function"))return;let t=typeof e.getState=="function"||typeof e._getState=="function",a=typeof e.setState=="function"||typeof e._setState=="function";if(typeof e.subscribe!="function")throw l("Store must have a subscribe method"),new Error("Store must have a subscribe method");if(!t&&!a)throw l("Store must have either getState/setState or _getState/_setState methods"),new Error("Store must have either getState/setState or _getState/_setState methods")}},Ct=Ta,Ia=class extends Te{constructor(e){if(super(),!e)throw l("Adapter provided is not defined"),new Error("Adapter provided is not defined");this.adapter=e,this._unsubscribe=null}_registerOnDataChanged(e){c("SvelteAdapter - Registering onDataChanged listener");try{if(!e)return;this.adapter.onDataChanged(async t=>{if(t.adapterId==this.adapter.adapterId||!t.origin)return;let a;e.subscribe(o=>{a=X({},o)})();let n;t.value?n=await this.adapter._decrypt(t.key,t.value):n=await this.adapter.get(t.key),JSON.stringify(a)!==JSON.stringify(n)&&e.update(o=>({...o,...n,STORAGEFY_SILENT_CHANNEL_UPDATE:!0}))})}catch(t){throw l("SvelteAdapter - onDataChanged error:",t),t}}async setInStorage(e,t,a={}){try{return c("SvelteAdapter - setInStorage - key:",t),this._checkStore(e),a.ignoreKeys=a.ignoreKeys||[],this._unsubscribe&&this._unsubscribe(),new Promise((n,o)=>{let h=e.subscribe(async u=>{try{if(!u)return n(!0);let p={...u};for(let y in p)a.ignoreKeys.includes(y)&&(p[y]=void 0);return await this.adapter.set(t,p,a.timeout),n(!0)}catch(p){return o(p)}});this._unsubscribe=h,a.syncTabs&&this._registerOnDataChanged(e)})}catch(n){throw l(n),n}}async getFromStorage(e,t){try{c("SvelteAdapter - getFromStorage - key:",t),this._checkStore(e);let a=await this.adapter.get(t);return a?(e.set(X({},a)),!0):void 0}catch(a){throw l(a),a}}_checkStore(e){if(!e||typeof e.subscribe!="function"||typeof e.set!="function")throw l("Store provided is not a valid Svelte writable store"),new Error("Store provided is not a valid Svelte writable store")}},Nt=Ia,ka={dbName:"storagefy",storeName:"storagefy_db",version:1,encrypt:!1,expireCheckInterval:1e3,description:"Storagefy database",adapter:"indexedDB"},v,x,me,be;function Ka(e={}){let t={...ka,...e};if(!e.forceRecreate&&v)return v;switch(t.adapter){case"localStorage":if(e.fresh)return new Ee(t);v=new Ee(t);break;case"sessionStorage":if(e.fresh)return new ve(t);v=new ve(t);break;default:if(e.fresh)return new xe(t);v=new xe(t)}return v}function K({adapter:e,adapterParams:t,forceRecreate:a},n,o){if(e)return new o(e);if(n&&!a)return n;if(t){let h=Da(t);return new o(h)}if(!v)throw new Error("Storage adapter not initialized. Call startStoragefy first.");return new o(v)}function Da(e){switch(e.adapter){case"localStorage":return new Ee(e);case"sessionStorage":return new ve(e);default:return new xe(e)}}function $a({adapter:e=null,adapterParams:t=null,forceRecreate:a=!1,fresh:n=!1}={}){return n?K({adapter:e,adapterParams:t,forceRecreate:a},null,At):(x=K({adapter:e,adapterParams:t,forceRecreate:a},x,At),{setInStorage:x.setInStorage.bind(x),getFromStorage:x.getFromStorage.bind(x)})}function Pa({adapter:e=null,adapterParams:t=null,forceRecreate:a=!1,fresh:n=!1}={}){return n?K({adapter:e,adapterParams:t,forceRecreate:a},null,Ct):(me=K({adapter:e,adapterParams:t,forceRecreate:a},me,Ct),me)}function Ra({adapter:e=null,adapterParams:t=null,forceRecreate:a=!1,fresh:n=!1}={}){return n?K({adapter:e,adapterParams:t,forceRecreate:a},null,Nt):(be=K({adapter:e,adapterParams:t,forceRecreate:a},be,Nt),be)}async function La(e,t,a={}){try{if(x||$a(),!e)throw new Error("Store is required.");if(!t)throw new Error("Key is required.");await x.getFromStorage(e,t),await x.setInStorage(e,t,a)}catch(n){throw logError(n),n}}export{Ct as B,Ee as D,Ka as a,Ra as d,Pa as h,$a as l,La as p};
