import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{a as u}from"./index.9MVAkNgL.js";import"./StorageAdapter.-Hf96jOd.js";import"./generateSimpleId.1pzoLIeQ.js";import"./sleep.B0B6IrN2.js";import v from"./LocalStorageAdapter.DbWFQp1Z.js";import"./assign.MzTrJBn8.js";import{R as N}from"./ReactAdapter.DGmXLvKE.js";const f=a=>{let s;const n=new Set,r=(d,h)=>{const l=typeof d=="function"?d(s):d;if(!Object.is(l,s)){const y=s;s=h??(typeof l!="object"||l===null)?l:Object.assign({},s,l),n.forEach(I=>I(s,y))}},c=()=>s,m={setState:r,getState:c,getInitialState:()=>j,subscribe:d=>(n.add(d),()=>n.delete(d))},j=s=a(r,c,m);return m},_=a=>a?f(a):f;let x=null,p=null;function C(){x=new v({dbName:"storagefy_zustand_test",storeName:"storagefy_zustand_test_db",description:"Storagefy Zustand database",adapter:"localStorage",channelName:"storagefy_zustand_test_channel",version:1,encrypt:!1,enableSyncTabs:!0}),p=new N(x)}C();function R(){return _((a,s)=>({items:[],addItem:n=>{const r=s(),t=r.items.find(o=>o.id===n.id)?r.items.map(o=>o.id===n.id?{...o,qty:o.qty+1}:o):[...r.items,{...n,qty:1}];a({items:t})},removeItem:n=>{const c=s().items.map(t=>t.id===n?{...t,qty:t.qty-1}:t).filter(t=>t.qty>0);a({items:c})},clear:()=>{a({items:[]})},getTotal:()=>s().items.reduce((n,r)=>n+r.price*r.qty,0)}))}const i=R(),b="React_CartStore_App";let g=!1;async function S(){try{return g||(await p.getFromStorage(i,b),await p.setInStorage(i,b,{syncTabs:!0}),g=!0),{cartStore:i,loadStores:S}}catch(a){console.error(a)}}S();function z(){const[a,s]=u.useState({items:[]}),[n,r]=u.useState(!1),c=[{id:1,name:"Wireless Mouse",price:29.99},{id:2,name:"Mechanical Keyboard",price:79.99},{id:3,name:"USB-C Hub",price:49.99},{id:4,name:"Monitor Stand",price:39.99}];return u.useEffect(()=>{let t;return(async()=>{await S(),s(i.getState()),t=i.subscribe(m=>s(m)),r(!0)})(),()=>{t&&t()}},[]),n?e.jsxs("section",{className:"shop-demo",children:[e.jsx("h2",{children:"ðŸ›ï¸ Mini Shop Demo"}),e.jsxs("div",{className:"store",children:[e.jsxs("div",{className:"items",children:[e.jsx("h3",{children:"ðŸ›’ Items"}),c.map(t=>e.jsxs("div",{className:"item",children:[e.jsxs("span",{children:[t.name," â€” $",t.price.toFixed(2)]}),e.jsx("button",{onClick:()=>i.getState().addItem(t),children:"Add"})]},t.id))]}),e.jsxs("div",{className:"cart",children:[e.jsx("h3",{children:"ðŸ§º Cart"}),a.items.length>0?e.jsxs(e.Fragment,{children:[a.items.map(t=>e.jsxs("div",{className:"item",children:[e.jsxs("span",{children:[t.name," Ã— ",t.qty]}),e.jsx("button",{onClick:()=>i.getState().removeItem(t.id),children:"Remove"})]},t.id)),e.jsx("button",{className:"clear",onClick:()=>i.getState().clear(),children:"Clear Cart"}),e.jsxs("div",{className:"total",children:["ðŸ’° Total: $",i.getState().getTotal().toFixed(2)]})]}):e.jsx("div",{children:"No items in cart"})]})]})]}):null}export{z as default};
